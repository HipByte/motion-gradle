buildscript {
  repositories {
    jcenter()
    mavenCentral()
  }
  dependencies {
    <% @classpaths.each do |classpath| %>
      classpath '<%= classpath %>'
    <% end %>
  }
}

allprojects {
  repositories {
    jcenter()
    mavenCentral()
  }
}

apply plugin: 'java'
apply plugin: 'eclipse'
<% @plugins.each do |plugin| %>
  apply plugin: '<%= plugin %>'
<% end %>

task generateDependencies(type: Copy) {
  from sourceSets.main.runtimeClasspath
  into 'dependencies/'
}

repositories {
  <% if android_repository %>
    maven {
      url "<%= ENV['RUBYMOTION_ANDROID_SDK'].shellescape %>/extras/android/m2repository/"
    }
  <% end %>
  <% if google_repository %>
    maven {
      url "<%= ENV['RUBYMOTION_ANDROID_SDK'].shellescape %>/extras/google/m2repository/"
    }
  <% end %>
  <% @repositories.each do |url| %>
    maven {
      url "<%= url %>"
    }
  <% end %>
}

dependencies {
  <% @libraries.each do |library| %>
    compile project(':<%= library[:name] %>')
  <% end %>
  <% @dependencies.each do |dependency| %>
    <% if dependency.is_a?(LegacyDependency) %>
      <%= dependency.parse %>
    <% else %>
      compile '<%= dependency %>'
    <% end %>
  <% end %>
}
